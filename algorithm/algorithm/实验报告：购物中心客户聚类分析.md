## 实验报告：购物中心客户聚类分析

------

## 聚类

按照某个特定标准把一个数据集分割成不同的类或簇，使得同一个簇内的数据对象的相似性尽可能大，同时不在同一个簇中的数据对象的差异性也尽可能大。

属于无监督学习方法。

## 聚类的一般过程

**数据准备**：特征标准化和降维。

**特征选择**：从最初的特征中选择**最有效的特征**，并将其存储在向量中。

**特征提取**：通过对选择的特征进行转换形成**新的突出特征**。

**聚类**：基于某种**距离函数**进行**相似度度量**，获取簇。

**聚类结果评估**：分析聚类结果。

### 一、求解问题描述

本实验旨在对购物中心客户数据进行聚类分析，通过客户的**年收入**和**消费分数**等特征将客户划分为不同群体。通过聚类算法，可以帮助商家更好地了解客户群体特征，从而制定针对性的营销策略。数据集包含客户的性别、年龄、年收入和消费分数等信息。  数据集包含200位客户的以下信息：

- `CustomerID`：客户唯一标识
- `Genre`：性别（Male/Female）
- `Age`：年龄
- `Annual Income (k$)`：年收入（千美元）
- `Spending Score (1-100)`：消费评分（1-100分）

**核心目标**：

1. 识别具有相似消费行为的客户群体
2. 分析不同性别客户的消费模式差异
3. 为商家提供精准营销策略依据

------

### 二、算法描述

#### 1. K-means 聚类

**原理**：

- 初始化随机聚类中心，迭代优化类内距离平方和
- 计算样本到聚类中心的欧氏距离，分配到最近类
- 更新聚类中心为该类样本的均值
- 重复直至中心点变化小于阈值



#### 2. K-means++ 聚类

**改进点**：

- 优化初始中心选择：首个中心随机选取，后续中心以概率 D(x)2∑D(x)2∑*D*(*x*)2*D*(*x*)2 选择（D(x)*D*(*x*) 为到最近中心的距离）

- 减少迭代次数，避免陷入局部最优

  

#### 3. DBSCAN 聚类

**原理**：

- 基于密度定义簇：核心点（邻域内样本数≥ `min_samples`）、边界点、噪声点
- 参数：邻域半径 `eps`，最小样本数 `min_samples`
- 流程：
  1. 标记核心点
  2. 合并密度可达的核心点形成簇
  3. 将边界点分配给相邻簇
  4. 剩余点为噪声

#### 4. 层次聚类

**原理**：

- 自底向上凝聚法：初始每个样本为一类

- 使用 `ward` 方法计算类间距离（最小化合并后的类内方差）

- 递归合并距离最小的两类，直至达到预设簇数量 `n_clusters`

  

  

------

### 三、改进策略

#### 1. 数据预处理改进

- **标准化处理**：所有算法使用 `StandardScaler` 标准化特征，消除量纲影响：

  

  

#### 2. 算法优化

| 算法         | 改进策略                        | 优势                           |
| :----------- | :------------------------------ | :----------------------------- |
| **K-means**  | 随机初始化多次，选择最佳结果    | 减少局部最优风险               |
| **DBSCAN**   | 动态调整 `eps` 和 `min_samples` | 适应数据密度分布（如性别分组） |
| **层次聚类** | 选用 `ward` 链接方法            | 生成更均匀的簇大小             |

#### 3. 可视化增强

- 使用 `seaborn` 绘制高分辨率散点图
- 标记聚类中心和噪声点（DBSCAN）
- 按性别分组对比（如男性/女性独立聚类）

------

### 四、实验结果与分析

#### 1. 整体聚类结果对比

| 算法      | 簇数量 | 噪声点 | 特点                          |
| :-------- | :----- | :----- | :---------------------------- |
| K-means   | 5      | 0      | 簇大小均匀，中心点明确        |
| K-means++ | 5      | 0      | 中心点更稳定，收敛速度提升20% |
| DBSCAN    | 4      | 15     | 发现非球形簇，识别离群点      |
| 层次聚类  | 5      | 0      | 树状图可解释性强，簇层次清晰  |

#### 2. 关键发现

- **高消费高收入群体**（右上角簇）：
  - 年收入 > 70k$，消费评分 > 60
  - 占比15%，需重点维护
- **低收入高消费群体**（左上角簇）：
  - 年收入 < 40k$，消费评分 > 70
  - 多为年轻人，适合促销活动
- **性别差异**：
  - 女性在高收入区间更集中
  - 男性在中等收入区间分布更广

#### 3. 算法对比总结

| 指标         | K-means | DBSCAN | 层次聚类 |
| :----------- | :------ | :----- | :------- |
| 簇形状适应性 | 差      | 优     | 中       |
| 噪声处理     | 无      | 优     | 无       |
| 参数敏感性   | 中      | 高     | 低       |
| 计算效率     | 高      | 中     | 低       |

> **最佳实践**：
>
> - 规则数据：K-means++（效率与质量平衡）
> - 复杂分布：DBSCAN（自动识别簇形状和噪声）
> - 小规模数据：层次聚类（可解释性强）

------

### 结论与建议

1. **客户分群策略**：
   - 针对高收入群体推出高端会员服务
   - 对年轻低收入群体设计分期付款方案
2. **算法选择**：
   - 默认推荐 K-means++（参数少，结果稳定）
   - 数据分布复杂时切换至 DBSCAN
3. **后续优化**：
   - 引入年龄维度进行三维聚类
   - 结合分类算法预测新客户群体

------

**附图**：

- 图1：K-means++ 聚类结果（5个簇）
- 图2：DBSCAN 噪声点分布（红色为噪声）
- 图3：性别对比聚类（左：男性，右：女性）

> 实验代码详见：https://github.com/SivanRWX/ClusteringTest.git

